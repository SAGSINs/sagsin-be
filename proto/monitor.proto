syntax = "proto3";

package monitor;

service NodeMonitor {
  rpc Heartbeat (stream HeartbeatRequest) returns (HeartbeatResponse);
}

message LinkMetric {
  string neighbor_id = 1;
  double delay_ms = 2;
  double jitter_ms = 3;
  double loss_rate = 4;
  double bandwidth_mbps = 5;
  bool available = 6;
  int32 queue_length = 7;
}

message NodeMetric {
  double cpu_load = 1;
  double jitter_ms = 2;
  int32 queue_len = 3;
  double throughput_mbps = 4;
}

message HeartbeatRequest {
  string ip = 1;
  string hostname = 2;
  repeated LinkMetric links = 3;
  NodeMetric node_metrics = 4;
  double lat = 5;
  double lng = 6;
}

message HeartbeatResponse {
  bool success = 1;
  string message = 2;
}
